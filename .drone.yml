---
depends_on: []
kind: pipeline
name: ci
services:
- image: docker:24-dind
  name: docker
  privileged: true
  volumes:
  - name: dockersock
    path: /var/run
steps:
- commands:
  - make tools-image-build registry=reg.dist.svc.cluster.znet:5000
  - make tools-image-push registry=reg.dist.svc.cluster.znet:5000
  image: reg.dist.svc.cluster.znet:5000/zachfi/streamgo-ci-tools:latest
  name: build-tools
  pull: always
  volumes:
  - name: dockersock
    path: /var/run
  when:
    ref:
    - refs/heads/main
- commands:
  - make compile-only
  image: reg.dist.svc.cluster.znet:5000/zachfi/streamgo-ci-tools:latest
  name: compile-only
  pull: always
- commands:
  - make docker registry=reg.dist.svc.cluster.znet:5000
  - make docker-push registry=reg.dist.svc.cluster.znet:5000
  image: reg.dist.svc.cluster.znet:5000/zachfi/streamgo-ci-tools:latest
  name: build-app
  pull: always
  volumes:
  - name: dockersock
    path: /var/run
  when:
    ref:
    - refs/heads/main
trigger:
  ref:
  - refs/heads/main
  - refs/heads/dependabot/**
  - refs/pull/*/head
volumes:
- name: dockersock
  temp: {}
---
kind: signature
hmac: b15dded71d791bcffcdfbd4b34800ce6482671d47eeb9cdc9b666c113cbd0bb8

...
